<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>FF Bar Vitrine</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial,Helvetica,sans-serif;
}

/* ===== TOPO ===== */
.top-images{
  height:180px;
  background:#fff;
  padding:10px;
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:10px;
}
.top-images img{
  width:100%;
  aspect-ratio:1/1;
  object-fit:cover;
  border-radius:8px;
}

/* ===== LAYOUT ===== */
.container{
  display:flex;
  height:calc(100vh - 180px);
}

/* ===== MENU ===== */
.menu{
  width:220px;
  background:#111;
  padding:10px;
}
.menu h3{
  margin-top:0;
}
.menu button{
  width:100%;
  margin-bottom:8px;
  padding:12px;
  background:#00c2ff;
  border:none;
  font-weight:bold;
  cursor:pointer;
}
.menu input{
  width:100%;
  margin-bottom:10px;
}

/* ===== PLAYER ===== */
.player{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}
audio{
  display:none;
}
canvas{
  width:80%;
  height:200px;
  margin-top:20px;
  background:#000;
}

/* ===== LATERAL ===== */
.lateral{
  width:200px;
  background:#fff;
  padding:10px;
  display:grid;
  grid-template-rows:repeat(5,1fr);
  gap:10px;
}
.lateral img{
  width:100%;
  aspect-ratio:1/1;
  object-fit:cover;
  border-radius:8px;
}
</style>
</head>

<body>

<!-- TOPO -->
<div class="top-images" id="topImages"></div>

<div class="container">

  <!-- MENU -->
  <div class="menu">
    <h3>üéµ G√™nero</h3>
    <button onclick="setGenero('sertanejo')">Sertanejo</button>
    <button onclick="setGenero('brega')">Brega</button>
    <button onclick="setGenero('piseiro')">Piseiro</button>
    <button onclick="setGenero('forro')">Forr√≥</button>

    <hr>

    <label>üìÇ Pasta de m√∫sicas</label>
    <input type="file" id="musicas" webkitdirectory multiple>

    <label>üñºÔ∏è Imagens</label>
    <input type="file" id="imgs" accept="image/*" multiple>

    <button onclick="tocar()">‚ñ∂ TOCAR</button>
  </div>

  <!-- PLAYER -->
  <div class="player">
    <h2 id="titulo">Escolha um g√™nero</h2>
    <audio id="audio"></audio>
    <canvas id="visualizer"></canvas>
  </div>

  <!-- LATERAL -->
  <div class="lateral" id="lateralImgs"></div>

</div>

<script>
let generoAtual = null;
let musicas = [];
let index = 0;

/* ===== G√äNERO ===== */
function setGenero(g){
  generoAtual = g;
  titulo.innerText = "üé∂ " + g.toUpperCase();
  musicas = [];
}

/* ===== M√öSICAS ===== */
const musicasInput = document.getElementById("musicas");
musicasInput.onchange = () => {
  if(!generoAtual){
    alert("Escolha o g√™nero primeiro");
    musicasInput.value = "";
    return;
  }
  musicas = [...musicasInput.files];
};

/* ===== PLAYER ===== */
const audio = document.getElementById("audio");

function tocar(){
  if(!musicas.length){
    alert("Nenhuma m√∫sica carregada");
    return;
  }
  audio.src = URL.createObjectURL(musicas[index]);
  audio.play();
  iniciarVisualizer();

  audio.onended = ()=>{
    index = (index + 1) % musicas.length;
    tocar();
  };
}

/* ===== IMAGENS ===== */
const imgs = document.getElementById("imgs");
const topImages = document.getElementById("topImages");
const lateralImgs = document.getElementById("lateralImgs");

imgs.onchange = ()=>{
  topImages.innerHTML = "";
  lateralImgs.innerHTML = "";

  const files = [...imgs.files];

  // TOPO ‚Äì 6 imagens
  files.slice(0,6).forEach(file=>{
    const img = document.createElement("img");
    img.src = URL.createObjectURL(file);
    topImages.appendChild(img);
  });

  // LATERAL ‚Äì 5 imagens
  files.slice(6,11).forEach(file=>{
    const img = document.createElement("img");
    img.src = URL.createObjectURL(file);
    lateralImgs.appendChild(img);
  });
};

/* ===== VISUALIZER ===== */
const canvas = document.getElementById("visualizer");
const ctx = canvas.getContext("2d");
let audioCtx, analyser, data;

function iniciarVisualizer(){
  if(audioCtx) return;
  audioCtx = new AudioContext();
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 256;
  data = new Uint8Array(analyser.frequencyBinCount);
  const src = audioCtx.createMediaElementSource(audio);
  src.connect(analyser);
  analyser.connect(audioCtx.destination);
  draw();
}

function draw(){
  requestAnimationFrame(draw);
  analyser.getByteFrequencyData(data);
  ctx.fillStyle = "#000";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  let x = 0;
  const w = canvas.width / data.length;
  data.forEach(v=>{
    ctx.fillStyle = `rgb(${v+80},50,50)`;
    ctx.fillRect(x, canvas.height - v, w, v);
    x += w;
  });
}
</script>

</body>
</html>
